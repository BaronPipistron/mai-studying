# Отчёт по лабораторной работе
## Свёрточные нейронные сети

### Студенты: 

| ФИО                       | Группа      | Роль в проекте | Оценка       |
|---------------------------|-------------|----------------|--------------|
| Концебалов Олег Сергеевич | М8О-309Б-22 | Сделал все     |              |


> *Комментарии проверяющего*

## Первая часть

Для решения задачи классификации изображений домашних животных были выбраны фреймворки PyTorch и TorchVision. В работе рассматривались два типа классификации: бинарная (кошки/собаки) и многоклассовая (35 пород животных).

1. Подготовка данных
Был загружен датасет, состоящий из изображений домашних животных, и разделен на обучающую и тестовую выборки с соотношением 4 к 1 (80%/20%) с сохранением стратификации по классам. Для бинарной классификации использовались метки "cat" и "dog", для многоклассовой - названия конкретных пород.

2. Архитектура модели
Основная задача заключалась в разработке эффективной архитектуры сверточной нейронной сети. Была реализована следующая структура:

```python
class NetWork(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(3, 6, 3)
        self.pool1 = nn.MaxPool2d(2)
        self.conv2 = nn.Conv2d(6, 12, 3)
        self.pool2 = nn.MaxPool2d(2)
        self.conv3 = nn.Conv2d(12, 24, 3)
        self.pool3 = nn.MaxPool2d(2)
        self.conv4 = nn.Conv2d(24, 90, 7)
        self.pool4 = nn.MaxPool2d(2)
        self.flatten = nn.Flatten()
        self.fc1 = nn.Linear(100*90, 128)
        self.activation1 = nn.LeakyReLU()
        self.fc2 = nn.Linear(128, 128)
        self.activation2 = nn.ELU()
        self.fc3 = nn.Linear(128, n_classes)
```
В процессе экспериментов были опробованы различные комбинации сверточных слоев и функций активации (LeakyReLU, ELU), что позволило достичь хороших результатов.

3. Обучение модели
Для улучшения качества классификации были применены следующие техники:

- Нормализация изображений

- Использование аугментаций (хотя явно не указаны в коде, предполагается их применение)

- Оптимизатор Adam

- Функция потерь CrossEntropyLoss

В результате для бинарной классификации была достигнута точность 85%, а для многоклассовой - 65% (Top-1) и 85% (Top-3).

4. Визуализация результатов
Для анализа работы модели были построены:

- Графики изменения функции потерь

- Графики точности (Top-1 и Top-3)

- Матрица ошибок для многоклассовой классификации

Таким образом, поставленные задачи были успешно решены, а модель показала хорошие результаты в классификации изображений домашних животных.

## Вторая часть

Для выполнения этой части был выбран фреймворк pytorch.

Загрузил датасет из сайта kaggle, состоящий из 7390 картинок котиков и собак 
разных пород, разделил его по классам, содержащимся в названии, а также на 
обучающую и тестовую выборки. Далее получил предобученные сети VGG16, VGG19 и ResNet 
и совершил их дообучение.

Судя по точности, ResNet оказалась немного лучше в задаче классификации, 
построил для неё Confusion Matrix.

## Третья часть

Для обучения нейросети использовался датасет 
[petfaces](http://www.soshnikov.com/permanent/data/petfaces.tar.gz) 
и предобученный классификатор ResNet, в качестве генеративной модели — 
генеративно-состязательная сеть.

## Вывод

Проделав лабораторную работу, я применил фреймворки для машинного обучения 
tensorflow и pytorch на практике, решил задачу бинарной классификации, обучив 
свёрточную нейросеть с нуля, и задачу классификации, воспользовавшись 
предобученной нейросетью. Я даже попробовали свои силы в генерации 
изображений, хоть это и не особо получилось. НО КОТИКА ВСЕ ЖЕ СГЕНЕРИРОВАТЬ ПОЛУЧИЛОСЬ!!!!
