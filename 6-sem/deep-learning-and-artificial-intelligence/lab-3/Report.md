## Отчёт по лабораторной работе

Выполнили:

Студент (ФИО)          | Роль в проекте                            | Оценка |
-----------------------|-------------------------------------------|--------|
Железнов Илья 310      | **одноправленная** и двунаправленная LSTM |        |
Недосекин Алксандр 309 | одноправленная и **двунаправленная** LSTM |        |
Артём Калиниченко 310  | Simple RNN, писал отчет, подбор датасета  |        | 
Воропаев Воропаев 309  | Simple RNN, поиск и подбор датасета       |        |
Концебалов Олег 309    | GPT                                       |        |

# Датасет
Наш датасет был заимствован с платформы Kaggle: BBC News Summary Dataset. Он основан на коллекции текстов с новостного сайта BBC, охватывающей период с 2004 по 2005 год. В общей сложности датасет включает 2225 новостных статей, классифицированных по пяти тематическим категориям. Особое внимание в нашем исследовании уделено 417 политическим статьям, размещённым в папке News Articles. Каждая из этих статей сопровождается пятью краткими резюме, представленными в папке Summaries. Тексты начинаются с заголовка, который отражает основную тему статьи.

# Simple RNN
## Посимвольный

Для работы с рекуррентной нейронной сетью были реализованы вспомогательные функции. Функция read_text(paths) используется для считывания текстовых файлов из датасета. Список spam_word содержит нежелательные слова, подлежащие удалению. Функция proceed_vocab(text) формирует множество уникальных символов текста, а proceed_text(symbols, text) — очищает предложения от указанных символов.

На следующем этапе данные были разделены на обучающую и валидационную выборки. Для корректной работы модели были созданы словари для преобразования символов в числовые индексы. Также был реализован специальный класс TextDataset, который преобразует текстовые данные в тензоры с добавлением специальных токенов. Внутри класса автоматически создаётся маска, обеспечивающая корректную обработку предложений переменной длины при обучении модели.


Создали класс SimpleRNN для определения модели, которая состоит из слоев: эмбеддинга, рекуррентного, полносвязного и проекционного.

Обучили модель на двух эпохах, процесс обучения визуализировали на графике.

Далее мы посчитали оценку производительности модели на валидационном наборе данных и получили: 4.983259385131126.

Сгенерировали текст для предложения 'A Christmas ' и получили 'A Christmas tree of a first quarter of the US , said the company is a rise of the first time to the US of the US , the same'

## По словам
Аналогично посимвольной обработке, для работы на уровне слов была реализована функция proceed(text: str), которая выполняет предварительную обработку текстовых данных. Она добавляет слова в словарь (vocab), преобразует предложения в тензоры и добавляет специальные токены, необходимые для обучения. По тому же принципу формируются обучающая и валидационная выборки, а также словари для преобразования слов в числовые индексы.

Модель была обучена на двух эпохах, а динамика обучения визуализирована с помощью графика, что позволило отследить изменения функции потерь и оценить качество обучения.

Далее мы посчитали оценку производительности модели на валидационном наборе данных и получили: 87.03943008846707.

Сгенерировали текст для предложения 'A Christmas tree ' и получили 'A Christmas tree of the film , which has been nominated in the two years .'

# Однонаправленный LSTM
Аналогично предыдущему алгоритму вначале происходит подготовка датасета, разделение на валидационный и тренировочный. Далее реализовывется класс данной модели. 

Для дальнейшего исследования будем менять количество слоев.

При одном слое: validate_model = 4.69530398695619

Из 'A Christmas ' получается сгенерировать 'A Christmas in the Apple will be a could search in the plans a going to recent to be the world for t'

При 5 слоях  validate_model = 6.250707007232524

Из 'A Christmas ' получается сгенерировать 'A Christmas the said and the particicial at the intert ut the tink the prevent said the said and an '

Дальше мы меняли способы токенизации, это можно посмотреть в соответствующем файле .ipynb. 

Подводя итоги, можно сделать вывод, что лучше всего себя показали токенизаторы по словам, которые дают порой хорошие связанные предложения, связанные по смыслу. Также обратим внимание на то, что однослойные LSTM справляются лучшше, чем многослойные. Возможно, стоило уменьшить количество слоев с 5 на меньшее число

# Двунаправленный LSTM
Аналогично предыдущему алгоритму вначале происходит подготовка датасета, разделение на валидационный и тренировочный. Далее реализовывется класс данной модели. Двунаправленность данной модели задается в 
model = LSTMModel(word2ind, num_lstm_layers=3, hidden_dim=256, dropout=0.2, bidirectional=True), а именно параметр bidirectional=True влияет на это.

Полученные результаты:
validate_model = 1.1647192471557193
Из 'A Christmas ' получается сгенерировать "A Christmas tree With South Christmas great American summer believes within turn age firm goal goal 4 phone research Street six general deficit goal second boss League August 2 !"

# Дообучение предобученной GPT-сети

Сначала произведем подготовительный этап в виде скачивания датасета, необходимых библиотек. 

Дальше определим класс и методы в нем для отслеживания информации об использовании GPU памяти и времени выполнения операций.

Подготовливаем датасет к обучению и дообучаем скачанную модель за 15 эпох при заданных параметрах. 

Далее была написана функция для генерации текста из предложения. В итоге из предложения "The other common type of ink in elections is indelible visible ink" модель сгенерировала текст: The other common type of ink in elections is indelible visible ink, which is so popular that the parties are forced to use."It's the first time I had been seeking the performer to be aware of the ink," said the campaign manager of independent electronic gaming firm Crysis.More than 40,000 people in the country have been cast in campaigns in recent months, with the goal of spending just £3.6bn in the way it is used to get the electronic music downloads.Few European electronic music players can be used to download or sell on a computer.One method of ink is a video recorder that can pause downloads and record results, which can be used to record results for different electronic music firms and other people using a computer to send video on the screen.Users of electronic gaming software can also download
